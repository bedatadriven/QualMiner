# Part of speech tagging {-}

We use the UDPipe library with the corresponding udpipe R package for PoS
(part-of-speech tagging) and dependency parsing. UDPipe library is using
Universal Dependencies[^6].

> Universal Dependencies (UD) is a framework for consistent annotation of
grammar (parts of speech, morphological features, and syntactic dependencies)
across different human languages.

UDPipe package also offers tokenization and lemmatization; however, they are not
the essential processes for this part because they are done in previous pages
(see the [**section**](#textual-data-preparation)).

```{r}
udpipe_example_from_vbg <- "UNFPA ha implementado un espacio seguro para la atención de mujeres en movilidad humana y gestión de casos en Sucumbíos-Puente San Miguel."
udpipe_example_from_vbg_annotated <- udpipe::udpipe_annotate(udmodel_spanish, x = udpipe_example_from_vbg)
invisible(udpipe_example_from_vbg_annotated$conllu)
```

Universal Dependencies also provides a visualization tool for the CoNLL-U format, 
[CoNLL-U file viewer](https://universaldependencies.org/conllu_viewer.html).

For example, an example sentence from the response taken from the **Protección_VBG** is visualized
via the file viewer tool as below.

Sentence:

> `r udpipe_example_from_vbg`

Visualization:

```{r}
knitr::include_graphics(file.path("..", "media", "conllu-tree-vbg-example.png"))
```

UDPipe returns an output in a format called **CoNLL-U**[^7]. The output format
is quite extensive and detailed, and we do not use all the features
existing in the output, mainly the `upos` column is critical for us.

Here is the description of the columns below. Please go to the specified links
in the table for more detailed answers.

| Column name | Description |
|:------------|:------------|
| `token` | word which can be analyzed as a single item |
| `lemma` | non-*inflected*[^8] form of word |
| `upos` | universal part-of-speech tag. see [**here**](https://universaldependencies.org/u/pos/index.html) |

```{r, eval=TRUE, cache=TRUE}
uniq.response.tokens_stopw <- unique(response.tokens_stopw$word)
udpipe_spanish_path <- file.path("data-raw", "spanish-gsd-ud-2.4-190531.udpipe")
udmodel_spanish <- udpipe::udpipe_load_model(file.path("..", udpipe_spanish_path))
annotated <- udpipe::udpipe_annotate(udmodel_spanish, x = uniq.response.tokens_stopw)
annotated <- tibble::as_tibble(annotated) %>% 
  select(token, lemma, upos)
```

```{r}
head(annotated)
```

Unique part-of-speech tags in the responses:
```{r}
tibble::as_tibble(as.data.frame(t(unique(annotated$upos)))) %>% 
  gt() %>% 
  gt_condensed_style()
```

```{r}
pos_most_common_plot <- function(upos.type) {
  
}
pos_most_common_plot("NOUN")
```

#### Most common word classes

"Word classes" are here nouns, verbs, adjectives, and adverbs.

#### Most common noun phrases in the responses

`TODO`



The tokenization and lemmatization are briefly explained in textual data processing part.

[^6]: Universal Dependencies <https://universaldependencies.org/>

[^7]: Described at <http://universaldependencies.org/format.html> Accessed 2019-09-05.

[^8]: > In morphology, inflection (or inflexion) is a process of word formation, in which a word is modified to express different grammatical categories such as tense, case, voice, aspect, person, number, gender, mood, animacy, and definiteness. <https://en.wikipedia.org/wiki/Inflection> Accessed 2019-09-05.
